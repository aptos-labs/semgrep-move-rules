rules:
  - id: public-friend-entry
    languages: [move_on_aptos]
    message: Public friend functions should not be entry points.
    severity: ERROR
    confidence: HIGH
    patterns:
      - pattern-not: |
          #[test_only]
          fun $FUN (...) : ...
      - pattern-not: |
          #[test]
          fun $FUN (...) : ...
      - pattern-not: |
          #[test(...)]
          fun $FUN (...) : ...
      - pattern: |
          public(friend) entry fun $FUN (...) : ...
